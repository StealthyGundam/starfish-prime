<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RobCo Terminal Cipher Grid - Free Text with Inputs</title>
<style>
html, body {
  margin:0; padding:0;
  width:100%; height:100%;
  font-family:'Courier New', monospace;
  background:#010; color:#0f0;
  overflow-y:auto; overflow-x:hidden;
  line-height:1.4;
}
body { padding:20px; }

/* CRT text glow/flicker */
.terminal-line {
  display:block;
  color:#0f0;
  text-shadow:0 0 2px #0f0,0 0 4px #0f0;
  white-space:pre-wrap;
  animation: flicker 2s infinite alternate;
}
.terminal-line.glitch {
  animation: glitchFlicker 0.2s infinite;
}

/* Input lines */
.input-line { display:flex; align-items:center; margin:2px 0; }
.input-line span.label { margin-right:5px; }
.input-line input {
  background:#010; color:#0f0; border:none; border-bottom:1px solid #0f0;
  outline:none; font-family:'Courier New', monospace; font-size:16px; width:150px; text-transform:uppercase;
}

/* Grid wrapper */
.grid-wrapper { display:flex; justify-content:center; align-items:flex-start; padding:10px; position:relative; overflow:hidden; opacity:0; transition:opacity 0.5s; }
.grid-wrapper::before { content:""; position:absolute; top:0; left:0; width:100%; height:100%; background: repeating-linear-gradient(to bottom, rgba(0,0,0,0) 0px, rgba(0,0,0,0.08) 1px); pointer-events:none; z-index:2; }
.grid-wrapper::after { content:""; position:absolute; top:0; left:0; width:100%; height:100%; background: radial-gradient(circle at center, rgba(0,255,0,0.05) 0%, transparent 80%); pointer-events:none; z-index:1; animation: pulseGlow 3s infinite alternate; }

/* Grid */
.grid { display:grid; grid-template-columns:repeat(20,1fr); grid-template-rows:repeat(20,1fr); width:100%; max-width:90vmin; aspect-ratio:1/1; z-index:3; position:relative; }
.cell { display:flex; align-items:center; justify-content:center; font-size:clamp(10px,2vw,18px); line-height:1; color:#0f0; text-shadow:0 0 2px #0f0,0 0 4px #0f0; animation: flicker 2s infinite alternate; }
.solved .cell { color:#0ff; text-shadow:0 0 6px #0ff,0 0 12px #0ff; }
.cell.glitch { animation: glitchFlicker 0.2s infinite; }

@keyframes flicker { 0%,19%,21%,23%,25%,54%,56%,100%{opacity:1;} 20%,22%,24%,55%{opacity:0.5;} }
@keyframes glitchFlicker {0%,50%,100%{opacity:1;} 25%,75%{opacity:0;}}
@keyframes pulseGlow {0%{opacity:0.03;}50%{opacity:0.08;}100%{opacity:0.03;}}
</style>
</head>
<body>

<div id="terminal"></div>

<div class="grid-wrapper">
  <div id="grid" class="grid"></div>
</div>

<script>
// Cipher setup
const PRIME_KEY=23n, MOD=29n;
const BASE_ALPHABET=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ ,."];
const CIPHER_TEXT="TGVN,XOWVTHNVA, SDV IGFV OGVNT X,EGFVLSOWNVEHMVHOVPTGVM  O,HWTP.VSVBS,SEHOVISMBHFGVTGVRS,DGEVRHPTV SPTVSOEVTXOWGFVUS,SOAGEVUZVLSHPT.VPTGVAHPZVDOGRVTHNVIHWH,VSOEVLG,PVNSLGFVSPVOHWTP.VGMBPZVNPFGGPNVNHWTGEVSNVTGVEGBSFPGEVP VNGFIGVSVYXHGPVAS,,V LVEXPZ.VS,,GZNVFGMGMUGFGEVTHNVNMH,GVTHNVMGFAZVTHNVNPGG,VFGN I,G.VL FVO RVTGVRSNVW OGVUXPVTHNVBF MHNGVFGMSHOGE.VPTGVM  OVRHPOGNNVSOEVU,GNNGEVTHNVFHWTPG XNVBSPT.";
const CORRECT_KEYWORD="SUNBLOCKER";
const CORRECT_KEY=(function(){let a=23n,m=28n,t,q,x0=0n,x1=1n;while(a>1n){q=a/m;t=m;m=a%m;a=t;t=x0;x0=x1-q*x0;x1=t;}if(x1<0n)x1+=m;return x1;})();

const terminal=document.getElementById("terminal");
const grid=document.getElementById("grid");

// Precreate 400 grid cells
const cells=[];
for(let i=0;i<400;i++){let c=document.createElement("div");c.className="cell";c.textContent=" ";grid.appendChild(c);cells.push(c);}

// Render grid
function renderGrid(chars,solved){grid.classList.toggle("solved",solved);for(let i=0;i<400;i++)cells[i].textContent=chars[i]||" ";}

// Update function
function update(){
  const keyInput=document.getElementById("key");
  const keywordInput=document.getElementById("keyword");
  if(!keyInput || !keywordInput) return;
  const keyV=keyInput.value?BigInt(keyInput.value):0n;
  const cipherAlphabet=[...new Set(keywordInput.value.toUpperCase().split("").filter(c=>BASE_ALPHABET.includes(c)))].concat(BASE_ALPHABET.filter(c=>!keywordInput.value.toUpperCase().includes(c)));
  const output=[];
  for(const char of CIPHER_TEXT){const idx=cipherAlphabet.indexOf(char);if(idx===-1){output.push(char);continue;}output.push(BASE_ALPHABET[Number((BigInt(idx)**keyV)%MOD)%BASE_ALPHABET.length]||char);}
  const solved=(keyInput.value===CORRECT_KEY && keywordInput.value.toUpperCase()===CORRECT_KEYWORD);
  renderGrid(output,solved);
}

// Glitch animation
function randomGlitch(){const count=Math.floor(Math.random()*5)+1;for(let i=0;i<count;i++){const idx=Math.floor(Math.random()*cells.length);cells[idx].classList.add("glitch");setTimeout(()=>cells[idx].classList.remove("glitch"),Math.random()*200+100);}}
setInterval(randomGlitch,100);

// Boot lines
let bootLines=[
  "ROBOCO INDUSTRIES UNIFIED OPERATING SYSTEM",
  "COPYRIGHT 2075-2077 ROBCO INDUSTRIES",
  "-RobCo Trespasser Management System-",
  "==========================",
  "| User Log:"
  // The two input lines will be replaced by actual inputs
];

// Typewriter effect
async function sleep(ms){return new Promise(r=>setTimeout(r,ms));}
async function typeBootLine(line){
  return new Promise(res=>{
    let i=0;
    const span=document.createElement("span");
    span.className="terminal-line";
    terminal.appendChild(span);
    const interval=setInterval(()=>{
      span.textContent+=line[i];
      i++;
      if(Math.random()<0.05) span.textContent+=String.fromCharCode(32+Math.floor(Math.random()*94));
      if(i>=line.length){ clearInterval(interval); terminal.appendChild(document.createElement("br")); res(); }
    },50);
  });
}

// Run boot sequence
async function runBoot(){
  // Type all boot lines except inputs
  for(const line of bootLines) await typeBootLine(line);

  // Append actual input fields instead of static text
  const inputHTML=`<div class="input-line">
  <span class="label">| >> Enter Decryption Key:</span>
  <input id="key" placeholder="XX" inputmode="numeric" pattern="\\d*" autocomplete="off">
</div>
<div class="input-line">
  <span class="label">| >> Enter Keyword:</span>
  <input id="keyword" placeholder="XXXXX" autocomplete="off">
</div>
<div class="terminal-line">&gt; run:// search -locked terminal</div>
<div class="terminal-line">&gt; LOG: Please enter correct decryption key and keyword for access...</div>`;
  terminal.insertAdjacentHTML('beforeend', inputHTML);

  // Add listeners
  document.getElementById("key").addEventListener("input",update);
  const kw=document.getElementById("keyword");
  kw.addEventListener("input",()=>{kw.value=kw.value.toUpperCase();update();});

  document.querySelector(".grid-wrapper").style.opacity="1";

  update();
}

runBoot();
</script>
</body>
</html>
